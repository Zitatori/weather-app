<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>スイスおてんき</title>
  <style>
    :root { color-scheme: light dark; }
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Noto Color Emoji";
      margin:0; padding:24px; background:#0b0b0b;
      color:#eaeaea;
    }
    .card{
      max-width: 720px; margin: 0 auto; background: #151515; border-radius: 16px;
      padding: 24px; box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    form{ display:flex; gap:8px; margin-bottom:16px; }
    input[type="text"]{
      flex:1; font-size:16px; padding:10px 12px; border-radius:12px; border:1px solid #333;
      background:#0f0f0f; color:#eaeaea;
    }
    button{
      font-size:16px; padding:10px 14px; border-radius:12px; border:1px solid #e5e5e5;
      background:#e5e5e5; color:#111; cursor:pointer;
    }
    .hero{
      display:flex; align-items:center; justify-content:space-between; gap:20px;
      margin-top:8px;
    }
    .left{
      display:flex; align-items:center; gap:16px;
    }
    .icon img{ width:72px; height:72px; display:block; filter: drop-shadow(0 4px 6px rgba(0,0,0,.35)); }
    .temp{ font-size:56px; font-weight:800; margin:4px 0; }
    .name{ font-weight:600; }
    .meta{ color:#bbb; margin-top:4px; }
    .character img{ width:140px; height:auto; display:block; }
    .error{ color:#ff7b7b; margin-top:8px; }

    /* 7日間予報 */
    .forecast{
      display:flex; gap:10px; margin-top:18px; overflow-x:auto; padding-bottom:6px;
    }
    .fcard{
      min-width:92px; background:#1f1f1f; border-radius:12px; padding:10px; text-align:center;
    }
    .ficon{ width:32px; height:32px; display:block; margin:0 auto 6px; }
    .ftemp{ font-weight:700; }
    .fmin{ opacity:.8; font-size:12px; }
    @media (max-width: 640px){
      .hero{ flex-direction:column; align-items:flex-start; }
      .character img{ width:120px; }
    }
  </style>
</head>
<body>
  <div class="card">
    <form method="get" action="/">
      <input type="text" name="city" placeholder="都市名（例: Zurich, Genève, Bern）" value="{{ query_city or '' }}" />
      <button type="submit">検索</button>
    </form>

    {% if error %}
      <p class="error">{{ error }}</p>
    {% else %}

      <!-- 上段：左に天気情報、右にゆるキャラ -->
      <div class="hero">
        <div class="left">
          <div class="icon">
            <img src="{{ url_for('static', path=icon.file) }}" alt="{{ icon.name }}" />
          </div>
          <div>
            <div class="temp">{{ temp }}°C</div>
            <div class="name">{{ city }}{% if country %}, {{ country }}{% endif %}</div>
            <div class="meta">風速: {{ windspeed }} km/h</div>
            <div class="meta">更新: {{ time }}</div>
            <div class="meta">キャラ名: {{ icon.name }}</div>
          </div>
        </div>
        <div class="character">
          <img src="{{ url_for('static', path=character) }}" alt="character" />
        </div>
      </div>

      <!-- 7日間予報 -->
      {% if daily and daily|length > 0 %}
        <div class="forecast">
          {% for d in daily %}
            <div class="fcard" title="{{ d.date }}">
              <div>{{ d.dow }}</div>
              <img class="ficon" src="{{ url_for('static', path=d.file) }}" alt="{{ d.dow }}" />
              <div class="ftemp">{{ d.tmax }}°</div>
              <div class="fmin">/{{ d.tmin }}°</div>
            </div>
          {% endfor %}
        </div>
      {% endif %}

    {% endif %}
  </div>
</body>
</html>

