<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>スイスおてんき</title>
  <style>
    :root { color-scheme: light dark; }
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Noto Color Emoji";
      margin:0; padding:24px; background:#f9fafb;
    }
    .card{
      max-width: 520px; margin: 0 auto; background: #fff; border-radius: 16px;
      padding: 24px; box-shadow: 0 10px 30px rgba(0,0,0,.07);
    }
    form{ display:flex; gap:8px; margin-bottom:16px; }
    input[type="text"]{
      flex:1; font-size:16px; padding:10px 12px; border-radius:12px; border:1px solid #ddd;
    }
    button{
      font-size:16px; padding:10px 14px; border-radius:12px; border:1px solid #111;
      background:#111; color:#fff; cursor:pointer;
    }
    .icon{ margin-top:4px; }
    .icon img{ width:72px; height:72px; display:block; filter: drop-shadow(0 4px 6px rgba(0,0,0,.15)); }
    .temp{ font-size:56px; font-weight:700; margin:8px 0; }
    .name{ font-weight:600; }
    .meta{ color:#555; margin-top:4px; }
    .error{ color:#b00020; margin-top:8px; }
    /* 7日間予報 */
    .forecast{
      display:flex; gap:10px; margin-top:16px; overflow-x:auto; padding-bottom:6px;
    }
    .fcard{
      min-width:84px; background:#f3f4f6; border-radius:12px; padding:10px; text-align:center;
    }
    .ficon{ width:36px; height:36px; display:block; margin:0 auto 6px; }
    .ftemp{ font-weight:700; }
    .fmin{ opacity:.7; font-size:12px; }
    /* ちょいダーク対応 */
    @media (prefers-color-scheme: dark){
      body{ background:#0b0b0b; }
      .card{ background:#151515; box-shadow: none; }
      input[type="text"]{ background:#111; border-color:#333; color:#eee; }
      button{ border-color:#e5e5e5; }
      .meta{ color:#bbb; }
      .fcard{ background:#1f1f1f; }
    }
  </style>
</head>
<body>
  <div class="card">
    <form method="get" action="/">
      <input type="text" name="city" placeholder="都市名（例: Zurich, Genève, Bern）" value="{{ query_city or '' }}" />
      <button type="submit">検索</button>
    </form>

    {% if error %}
      <p class="error">{{ error }}</p>
    {% else %}
      <!-- 現在の天気 -->
      <div class="icon">
        <img src="{{ url_for('static', path=icon.file) }}" alt="{{ icon.name }}" />
      </div>
      <div class="temp">{{ temp }}°C</div>
      <div class="name">{{ city }}{% if country %}, {{ country }}{% endif %}</div>
      <div class="meta">風速: {{ windspeed }} km/h</div>
      <div class="meta">更新: {{ time }}</div>
      <div class="meta">キャラ名: {{ icon.name }}</div>

      <!-- 7日間予報 -->
      {% if daily and daily|length > 0 %}
        <div class="forecast">
          {% for d in daily %}
            <div class="fcard" title="{{ d.date }}">
              <div>{{ d.dow }}</div>
              <img class="ficon" src="{{ url_for('static', path=d.file) }}" alt="{{ d.dow }}" />
              <div class="ftemp">{{ d.tmax }}°</div>
              <div class="fmin">/{{ d.tmin }}°</div>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endif %}
  </div>
</body>
</html>
